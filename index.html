 <!DOCTYPE html>
 <html lang="en">
 <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Salary Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudfare.com/ajax/libs/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css"> 
    <!-- <script href="script.js"></script> -->
 </head>

 <body>
    <div class="card">
      <h2>Employee Management</h2>
      <input type="text" id="empName" placeholder="Full Name">
      <input type="text" id="empDept" placeholder="Department">
      <input type="text" id="empHireDate" placeholder="YY-MM-DD">
      <button onclick="addEmployee()">Add Employee</button>
      <button onclick="getEmployees()">Get Employee</button>
      <button><a href="deleteEmployee.html">Delete Employee</a></button>
      <button onclick="updateEmployee()"><a href="updateEmployee.html">Edit Employee Info</a></button>

      <table border="1" style="width:100%">
         <thead>
            <tr>
            <th>ID</th>
            <th>Full Name</th>
            <th>Department</th>
            <th>Hire Date</th>
            <th>Actions</th>
            </tr>
         </thead>
         <tbody id="employeeTable"></tbody>
      </table>
    </div>
    <div class="card">
      <h2>Salary Management</h2>
      <input type="text" id="salaryMonth" placeholder="Month-Year">
      <input type="number" id="salaryAmount" placeholder="Amount">
      <input type="number" id="employeeId" placeholder="Employee ID">
      <button onclick="getSalary()">Get Employee's Salary</button>
      <button onclick="addSalary()">Add Salary</button>
      <button><a href="./updateSalary.html">Edit Employee's Salary</a></button>
      <button><a href="./deleteSalary.html">Delete Employee's Salary</a></button>

      <table border="1" style="width:100%">
         <thead>
            <tr>
            <th>ID</th>
            <th>Month-Year</th>
            <th>Amount</th>
            <th>Actions</th>
            <th>Actions</th>
            </tr>
         </thead>
         <tbody id="salaryTable"></tbody>
      </table>
    </div>
 </body>

 </html>

 <script>

 async function getSalary(){
    try {
        const response = await fetch(`https://localhost:7125/salaries`);

        if (!response.ok) {
            throw new Error("Failed to fetch Employee's Salaries");
        }

        const Salaries = await response.json();
        console.log(Salaries)
        const salaryTable = document.getElementById("salaryTable");
        salaryTable.innerHTML = "";

        Salaries.forEach(e => {
            const rowData = document.createElement("tr");
            rowData.innerHTML = `
                <td>${e.employeeId}</td>
                <td>${e.amount}</td>
                <td>${new Date(e.monthYear).toLocaleDateString("en-US", { month: "short", year: "numeric" })}</td>
            `;

            salaryTable.appendChild(rowData);
        });

    }
    catch(error) {
        console.error("Error loading Employee's Salary: ", error);
    }
}
async function getEmployees() {
    try {
        const endpoint = "https://localhost:7125/employees";
        const response = await fetch(endpoint);

        if (!response.ok) {
            throw new Error("Failed to fetch Employees");
        }

        const employees = await response.json();
        const employeetable = document.getElementById("employeeTable");
        employeetable.innerHTML = "";

        employees.forEach(e => {
            const rowData = document.createElement("tr");
            rowData.innerHTML = `
                <td>${e.employeeId}</td>
                <td>${e.fullName}</td>
                <td>${e.department}</td>
                <td>${new Date(e.hireDate).toISOString().split("T")[0]}</td>
            `;
            employeetable.appendChild(rowData);
        });

    } catch (error) {
        console.error("Error loading Employees: ", error);
    }
}


 

async function addEmployee(){
const name = document.getElementById("empName").value
const dept= document.getElementById("empDept").value
const hireDate= document.getElementById("empHireDate").value


if (!name || !dept || !hireDate){
    alert("Please fill all the fields")
}

const employee={
    fullName: name,
    department: dept,
    hireDate: hireDate,
}

try{
 
const response= await fetch("https://localhost:7125/add/employees", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(employee)
});

if (response.ok){
    const data= await response.json();
    console.log("Employee Added: ", data);
    alert("Employee Added Successfully");
    await getEmployees();
}
else {
    const err= await response.text();
    alert("Error adding employee: "+ err);
}
}
catch (error){
console.error("Fetch error: ", error)
alert("Could not connect to server")
}
}

async function addSalary(){
 const salaryMonth = document.getElementById("salaryMonth").value
 const salaryAmount = document.getElementById("salaryAmount").value
 const employeeId = document.getElementById("employeeId").value

 if (!salaryAmount || !salaryMonth || !employeeId){
   alert("Please fill all the fields")
 }

 const employeeSalary={
   amount:salaryAmount,
   monthYear: salaryMonth,
   employeeId:employeeId
 }

 try {
   const response= await fetch(`https://localhost:7125/salaries/${employeeId}`, {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(employeeSalary)
   });

   if (response.ok){
      const data= await response.json();
      console.log("Employee's salary added: ",data)
      alert("Salary Added Successfully")
   }
   else {
      const err= await response.text();
      alert("Error adding Employee's Salary: "+err)
   }
 }
 
   catch (error){
      console.error("Fetch error: ", error)
      alert("Could not connect to server")
   }
}


</script>
